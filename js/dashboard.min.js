/*
	Dashboard version 0.11.0 alpha
	(c) 2016 Epistemex
	www.epistemex.com
	MIT License
*/
function Dashboard(H){H=H||{};var F=this,J=E(H.idPrefix)?H.idPrefix+"_":"",e=0,O=H.tabIndexStart||1,c=H.callback,y=document,k=y.createElement.bind(y),z=y.getElementById.bind(y),x=i(),G=H.parent,I=G?(E(G)?z(G):G):y.body,A="pointer-events: none !important",P;x.className=H.css||"dashboard";if(H.id){x.id=H.id}b(I,x);function b(S){for(var R=1,Q=arguments;R<Q.length;R++){S.appendChild(Q[R])}}function M(S,Q,R){if(Q.cb){S.__cb=Q.cb.bind(R)}}function K(R,T,Q,S){R.dataset.type=T;if(!S){R.tabIndex=O++}if(Q.bind){R.dataset.bind=Q.bind}}function L(Q){return Q.parentNode.querySelectorAll("input")}function N(Q,S,R){if(!R){Q.value=S}Q.__v.innerHTML=Q.__tr?Q.__tr(Q.value):Q.value}function C(Q){return typeof Q==="boolean"}function E(Q){return typeof Q==="string"}function D(Q){return typeof Q!=="undefined"}function t(Q,V,U,aa,Y,T,Z){var S=q(Q),R=p(Q),W=o(Q,"range"),X=k("span");X.id=Q.id+"v";W.min=V;W.max=U;W.step=Y;W.value=Math.max(V,Math.min(U,aa));W.disabled=Q.dis;W.__v=X;W.__tr=Z;K(W,"slider",Q);M(W,Q,S);N(W,aa,!0);if(T){W.oninput=d}else{W.onchange=d;W.oninput=B}b(S,R,W,X);return S}function g(Q,S){var U=q(Q),T=p(Q),R=o(Q,"checkbox");R.checked=S;R.disabled=Q.dis;R.onchange=d;K(R,"checkbox",Q);M(R,Q,U);b(U,T,R);return U}function v(Q,V,T,U){var S=q(Q),R=p(Q),W=o(Q,"text");W.value=V;W.disabled=Q.dis;W.onchange=d;K(W,"textbox",Q);M(W,Q,S);if(U){W.placeholder=U}if(T){W.onkeyup=d}if(Q.cb){W.__cb=Q.cb.bind(S)}b(S,R,W);return S}function n(Q,U){var T=q(Q),S=p(Q),R=k("i");R.id=Q.id;R.innerHTML=U;R.disabled=Q.dis;K(R,"info",Q,!0);b(T,S,R);return T}function u(Q,T,R){var U=q(Q),S;if(R){U.innerHTML=T||""}else{S=k("p");S.innerHTML=T||"";S.id=Q.id;b(U,S)}return U}function r(R,U,S){var T=q(R),Q;Q=k("a");Q.innerHTML=U||"link";Q.href=S;Q.id=R.id;b(T,Q);return T}function h(Q,S){var U=q(Q),T=p(Q),R=o(Q,"color");T.style.cssText=A;R.value=S;R.disabled=Q.dis;R.onchange=d;K(R,"color",Q);M(R,Q,U);b(U,T,R);return U}function j(Q,U,W){var T=q(Q),S=p(Q),V=k("select"),R=0;V.id=Q.id;V.disabled=Q.dis;V.onchange=d;K(V,"dropdown",Q);M(V,Q,T);U.forEach(function(X){var Y=k("option");Y.innerHTML=X;if(R++===W){Y.selected="selected"}b(V,Y)});b(T,S,V);return T}function s(Q,R,V,W){var U=q(Q),T=i(),S=0;T.id=Q.id;T.innerHTML="<p>"+Q.lbl+"</p>";T.className="radio";K(T,"radio",Q,!0);b(U,T);V.forEach(function(Z){var X={lbl:Z,id:Q.id+"_"+S,cb:Q.cb},Y=i(),ab=o(X,"radio"),aa=p(X);Y.className="radio";ab.name=R;ab.id=X.id;ab.value=Z;ab.onclick=d;ab.disabled=Q.dis;K(ab,"radio",Q);M(ab,X,ab);if(S++===W){ab.checked="checked"}b(Y,ab,aa);b(U,Y)});return U}function f(Q,S){var U=q(Q),T=p(Q),R=k("button");T.style.cssText=A;R.id=Q.id;R.innerHTML=S;R.disabled=Q.dis;R.onclick=d;K(R,"button",Q);M(R,Q,U);b(U,T,R);return U}function m(Q,T){var S=q(Q),R=new Image;R.id=Q.id;R.src=T;R.disabled=Q.dis;K(R,"image",Q,!0);b(S,R);return S}function l(Q,V,S){var U=q(Q),T=i(),R=d.bind(T);U.className=S?"hidden":Q.css||"group";U.disabled=Q.dis;T.id=Q.id;T.innerHTML=Q.lbl;T.onclick=function(){if(this.disabled){return}U.className=this.__state?Q.css||"group":"hidden";this.__state=!this.__state;R()};T.onkeydown=function(W){var X=W.keyCode;if(X===37||X===39){this.__state=X===39}if([13,32,37,39].indexOf(X)>-1){W.preventDefault();this.dispatchEvent(new MouseEvent("click"))}};T.__state=S;K(T,"group",Q);M(T,Q,U);b(U,T);V.forEach(function(W){F.add(W,U)});return U}function a(Q,T){var S=q(Q),R=T.control;R.id=Q.id;R.__ecb=(T.onEnable||function(){}).bind(R);R.__set=(T.onSet||function(){}).bind(R);R.__get=(T.onGet||function(){}).bind(R);K(R,"custom",Q,!0);b(S,R);M(R,Q,S);return S}function i(){return k("div")}function q(Q){var R=i();R.className=Q.css||"line";if(!Q.show){R.style.display="none"}return R}function o(Q,S){var R=k("input");R.id=Q.id;R.type=S;return R}function p(Q){var R=k("label");R.setAttribute("for",Q.id);R.innerHTML=Q.lbl;return R}function d(){var R=this,Q=R.__cb;if(R.__v){N(R,R.value,!0)}if(Q){var V=F.value(R),U=R.dataset.type,T=U==="radio";if(R.__old!==V||U==="button"){clearTimeout(P);var S=R.id.substr(J.length);if(T){S=S.substr(0,S.lastIndexOf("_"))}P=setTimeout(Q({id:S,target:R,type:R.dataset.type,value:V,timestamp:Date.now()}),7);if(!T){R.__old=V}}}}function B(){N(this,this.value,!0)}function w(Q){(d.bind(Q))()}this.add=function(T,U){function R(V){if(E(V)){V=z(J+V)||z(V);if(V.dataset.type&&V.dataset.type==="group"){V=V.parentNode}}return V}if(Array.isArray(T)){var S=this;T.forEach(function(V){S.add(V,U)})}else{e++;b(R(U||T.parent||x),Q({id:J+(T.id||T.type+e),dis:!(C(T.enabled)?T.enabled:!0),css:T.css,show:C(T.show)?T.show:!0,lbl:T.label||(T.type+e),cb:T.callback||c,bind:T.bind}))}function Q(V){var W,Y=D(T.value)?T.value:0,X=T.text||"";switch(T.type){case"group":return l(V,T.items||[],T.collapsed);case"slider":if(Array.isArray(W=T.items)){return t(V,0,W.length-1,0,1,T.live,function(Z){return W[Z]})}else{return t(V,T.min||0,D(T.max)?T.max:100,Y,T.step||1,T.live,T.formatter)}case"checkbox":return g(V,T.checked);case"textbox":return v(V,X,T.live,T.placeholder);case"color":return h(V,T.color||"#ff0000");case"dropdown":return j(V,T.items,Y);case"radio":return s(V,T.group||"radiogrp_"+e,T.items,Y);case"button":return f(V,T.text||T.type+e);case"separator":return k("hr");case"info":return n(V,X);case"text":return u(V,X,T.raw);case"link":return r(V,X,Y);case"image":return m(V,Y);case"custom":return a(V,T);default:throw"Unknown type"}}return this};this.remove=function(Q){var R=E(Q)?z(J+Q):Q,S;if(!R||!R.dataset.type){throw"Unknown control"}S=R.parentNode;S.parentNode.removeChild(S);return this};this.value=function(R,X){var T=E(R)?z(J+R):R,V,U,Q,S,W=T.dataset.type;if(T&&W){if(arguments.length===2){switch(W){case"slider":N(T,X);break;case"checkbox":T.checked=X;break;case"image":T.src=X;break;case"group":T.__state=X;T.dispatchEvent(new MouseEvent("click"));break;case"color":case"textbox":case"radio":V=L(T);if(E(X)){for(Q=0;Q<V.length;Q++){if(V[Q].value===X){V[Q].checked="checked";break}}}else{V[X].checked="checked"}break;case"info":case"button":T.innerHTML=X;break;case"custom":T.__set(X);break;case"dropdown":if(typeof X==="number"){if(X>=0&&X<T.options.length){T.selectedIndex=X}}else{if(typeof X==="string"){for(Q=0,U=T.options,S=U.length;Q<S;Q++){if(U[Q].innerHTML===X){T.selectedIndex=Q;break}}}}break}return this}else{switch(W){case"slider":return +T.value;case"checkbox":return !!T.checked;case"image":return T.src;case"group":return !T.__state;case"color":case"textbox":return T.value;case"radio":V=L(T.type?T.parentNode:T);for(Q=0;Q<V.length;Q++){if(V[Q].checked){return Q}}return -1;case"info":case"button":return T.innerHTML;case"custom":return T.__get();case"dropdown":return T.selectedIndex}}}};this.enable=function(R,U){var S=E(R)?z(J+R):R,V=S.dataset.type,T,Q;if(S&&V){if(!U&&V==="group"){this.value(R,!1)}else{if(V==="radio"){T=L(S);for(Q=0;Q<T.length;Q++){T[Q].disabled=!U}}else{if(V==="custom"){if(S.__ecb){S.__ecb(U)}}else{S.disabled=!U}}}}return this};this.show=function(Q,S){if(arguments.length===1){x.style.display=Q?null:"none"}else{var R=E(Q)?z(J+Q):Q;if(R&&R.dataset.type){R.parentNode.style.display=S?null:"none"}}return this};this.bindTo=function(T){if(E(T)){T=JSON.parse(T)}var R=x.querySelectorAll("*"),Q,S=0,V;while(Q=R[S++]){if(Q.dataset.bind&&D(T[Q.dataset.bind])){if(Q.dataset.type==="radio"){var U=L(Q),W=T[Q.dataset.bind];for(V=0;V<U.length;V++){if(U[V].value===W){U[V].checked="checked";break}}}else{this.value(Q,T[Q.dataset.bind])}}}};this.getBound=function(){var T={},Q,S=0,R=x.querySelectorAll("*");while(Q=R[S++]){if(E(Q.dataset.bind)){if(Q.dataset.type==="radio"){var U=L(Q);for(var V=0;V<U.length;V++){if(U[V].checked){T[Q.dataset.bind]=U[V].value;break}}}else{T[Q.dataset.bind]=this.value(Q)}}}return T};this.getCallback=function(){return w}};